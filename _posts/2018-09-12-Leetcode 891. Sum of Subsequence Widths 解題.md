---
published: true
---
[原題連結](https://leetcode.com/articles/sum-of-subsequence-widths/)

先看看題目原文：

> Given an array of integers `A`, consider all non-empty subsequences of `A`.

> For any sequence S, let the *width* of S be the difference between the maximum and minimum element of S.

> Return the sum of the widths of all subsequences of A.
> As the answer may be very large, **return the answer modulo 10⁹ + 7**.

問題為輸入一個整數陣列$A$，考慮他所有的非空子集合，並且定義其寬度**(width)**為該子序列中，最大值和最小值之差，本題所求為*Ａ*之所有非空子集的width總和。

以下列例子為例，$A=[2,1,3]$，則A有下列之非空子集：

$[1],[2],[3],[1,2],[1,3],[2,3],[1,2,3]$ 

而其width之分別為0, 0, 0, 1, 2, 1, 2 其之和為6。

------

### **解題**

拿到這題的第一個想法便是先sorting，因為本題為集合問題，又需要子集之最大最小值，做sorting之後我們能得到許多好處，並一網打盡某case所有的permutation。

接著分析width的本質，我們先令陣列各項為$A_{i}, 1≤i≤n$，在另各項相鄰的差值為 $D_{i}=A_{i+1}-A_{i}$, 其中 $1≤i≤n-1$ ，事實上width即為這些差值所構成的，更精確點，若$A$的的非空子集 $S$，最大值為$A(q)$，最小值為$A(p)$，其 width $w_{s}$可表示為：

![img](https://cdn-images-1.medium.com/max/800/1*UW4P0YW4qC9qZlPyqEn1Lw.png)

若S只有一個元素，其width為trivial的0。

接著再回到三個元素的case來分析，先令$A=[A_{1},A_{2},A_{3}]$且已排序好：

![img](https://cdn-images-1.medium.com/max/800/1*Bqwa316koLu5_pfaowJQtQ.png)

考慮它所有子集的width值，再加總起來

![img](https://cdn-images-1.medium.com/max/800/1*UylP4nOX-VkaO3JTfhMMrA.png)

由結果發現它的總width值是可以寫成各項差值D(i)的線性組合，並且有個特定的係數(3,3)，那是不是能推廣到更多元素的case呢，答案是肯定的。

我寫了一段小程式把元素個數n=2…10的數列中，線性組合為個子集加總width的差值Di的係數給統計出來，結果如下

```
n = 2  ,[ 1]
n = 3  ,[ 3, 3 ] 
n = 4  ,[ 7, 9, 7 ]  (i.e.  total width = 7*D_1 + 9*D_2 + 7*D_3 )
n = 5  ,[ 15, 21, 21, 15 ] 
n = 6  ,[ 31, 45, 49, 45, 31 ] 
n = 7  ,[ 63, 93, 105, 105, 93, 63 ] 
n = 8  ,[ 127, 189, 217, 225, 217, 189, 127 ] 
n = 9  ,[ 255, 381, 441, 465, 465, 441, 381, 255 ] 
n = 10 ,[ 511, 765, 889, 945, 961, 945, 889, 765, 511 ]
```

可以發現，這些係數具有一些性質，即便不同元素個數的case，它們的係數都是左右對稱的，而且由於每多一個元素就會多一個差值，這些數字形成了一個三角形的形狀，使人聯想到國高中所見過的巴斯卡三角形，而為了觀察規律，我們不免俗地把它排成比較好看的三角形，如下：

![img](https://cdn-images-1.medium.com/max/800/1*ZKGtjp1JgTdakVpvFYNMaQ.png)

首先觀察邊的地方，從頂點延伸到兩邊的數列，正好是以 $2^{n}-1$的形式形成的

![img](https://cdn-images-1.medium.com/max/800/1*zgx_chjP5kcpT6A6uE-aHg.png)

![img](https://cdn-images-1.medium.com/max/800/1*43H04Uj20SqpkFvs1FawZQ.png)
